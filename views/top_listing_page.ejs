<% layout("/layouts/boilerplate") %>
<h1>Top Listings</h1>

<div class="container my-4">
    <div class="row row-cols-1 row-cols-lg-3 row-cols-md-2 row-cols-sm-2 gx-3">
        <% for (listing of listings) { %>
            <div class="col popup">
                <a href="/listing/<%= listing._id %>" style="text-decoration: none;">
                    <div class="card listing-card">
                        <% if (listing.image && listing.image.length > 0) { %>
                            <img src="<%= listing.image[0].url %>" class="card-img-top" alt="listing_image" />
                        <% } else { %>
                            <img src="default-image-url.jpg" class="card-img-top" alt="No image available" /> <!-- Fallback image -->
                        <% } %>
                        <div class="card-body">
                            <h4 class="card-title" style="color:black">
                                <%= listing.title.length > 26 ? listing.title.substring(0, 25) + '....' : listing.title %>
                            </h4>
                            <p class="mt-3">
                                <span class="price" data-base-price="<%= listing.price %>"><%= listing.price.toLocaleString("en-IN") %></span> / night
                                <span class="gst-label">(excl. GST)</span>
                            </p>
                            <p>❤️: <%= listing.likes %></p>
                            <p class="card-text location"><i class="fa-solid fa-location-crosshairs"></i>&nbsp; 
                                <%= listing.location %>, <%= listing.country %></p>
                            <a href="/listing/<%= listing._id %>" class="btn btn-dark show_btn">Show in Detail</a>
                        </div>
                    </div>
                </a>
            </div> <!-- End of .col -->
        <% } %>
    </div> <!-- End of row -->
</div> <!-- End of container -->